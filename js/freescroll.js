function Scroll(elem,o){if(!(this instanceof Scroll)){return new Scroll(elem,o);}
if(!this.g(elem)){return false};this.o=o||{};this.elem=this.g(elem);this.prevElement=this.o.prev?this.g(this.o.prev):"";this.nextElement=this.o.next?this.g(this.o.next):"";this.move=this.o.move||"w";this.speed=this.o.speed||30;this.o.auto===undefined?this.o.auto=true:this.o.auto;this.modWidth=0;this.isStop=0;this.timer="";this.init();};Scroll.prototype.init=function(){var that=this,mytime="",scroll=this.scrollAxes(),index=parseInt(this.o.index||0);if(!this.initHTML()){return false};this.elem.onmouseover=function(){clearTimeout(mytime);that.stop();};this.elem.onmouseout=function(){mytime=setTimeout(function(){that.start()},100);};this.prev();this.next();this.resetPrevNext();this.o.auto!==false?this.elem[scroll]=this.modWidth>0?this.modWidth+index:this.elem.scrollHeight/2+index:this.elem[scroll]=index;if(this.o.initCallback){this.o.initCallback()};setTimeout(function(){that.action();},this.o.rest||this.speed||1000);if(window.addEventListener){window.addEventListener("focus",function(){that.start()},false);window.addEventListener("blur",function(){that.stop()},false);}};Scroll.prototype.initHTML=function(){var contentHTML=this.elem.innerHTML,allWidthElem,innerWidthElem;if(this.scrollAxes()=="scrollTop"){if(this.elem.scrollHeight<=parseInt(this.getStyle(this.elem,"height"))){return false;}
if(this.o.auto===true){this.elem.innerHTML+=this.elem.innerHTML;}}else{this.elem.style.textAlign="left";allWidthElem=document.createElement("div");innerWidthElem=document.createElement("div");allWidthElem.style.position="absolute";allWidthElem.style.width="99999px";(document.all)?innerWidthElem.style.styleFloat="left":innerWidthElem.style.cssFloat="left";this.elem.innerHTML="";this.elem.appendChild(allWidthElem);allWidthElem.appendChild(innerWidthElem);innerWidthElem.innerHTML=contentHTML;this.modWidth=innerWidthElem.scrollWidth;allWidthElem.style.position="";if(this.elem.scrollWidth<=parseInt(this.getStyle(this.elem,"width"))){return false;}
if(this.o.auto===true){allWidthElem.innerHTML=contentHTML+contentHTML;allWidthElem.style.width=this.modWidth*2+"px";}else{allWidthElem.innerHTML=contentHTML;allWidthElem.style.width=this.modWidth+"px";}}
return true;};Scroll.prototype.action=function(c){if(this.isStop==1&&!c){return false};var that=this,scroll=this.scrollAxes(),isES=this.o.auto!==false&&(this.o.move=="e"||this.o.move=="E"||this.o.move=="s"||this.o.move=="S"),range=isES?-parseInt(this.o.range):parseInt(this.o.range),n=isES?-1:1;clearTimeout(this.timer);if(c){this.isStop=1;this.slowdown(this.elem[scroll]+parseInt(this.o.range)*c,function(){if(that.o.callback)that.o.callback();that.resetPrevNext();that.resetScroll();that.isStop=0;});}else if(this.o.rest){this.isStop=1;this.slowdown(this.elem[scroll]+range,function(){if(that.o.callback)that.o.callback();that.resetPrevNext();that.resetScroll();that.isStop=0;});}else if(!this.o.rest&&this.o.auto!=false){this.elem[scroll]+=n;that.resetScroll();}
if(this.o.auto!=false){this.timer=this.o.rest?setTimeout(function(){that.action()},this.o.rest):setTimeout(function(){that.action()},this.speed);}};Scroll.prototype.resetScroll=function(){if(this.o.auto==false){return false};var start=this.modWidth>0?this.modWidth:this.elem.scrollHeight/2,scroll=this.scrollAxes(),showScope=this.modWidth>0?this.elem.clientWidth:this.elem.clientHeight,scrollMax=this.modWidth>0?this.modWidth*2-showScope:this.elem.scrollHeight-showScope;if(this.elem[scroll]==0){this.elem[scroll]=start;}
if(this.elem[scroll]==scrollMax){this.elem[scroll]=start-showScope;}};Scroll.prototype.resetPrevNext=function(){if(this.o.auto!==false)return false;var axes=this.scrollAxes(),maxTopScope=this.modWidth>0?this.modWidth:this.elem.scrollHeight,boxDcope=this.modWidth>0?this.elem.clientWidth:this.elem.clientHeight,prevElem=this.g(this.o.prev),nextElem=this.g(this.o.next);if(prevElem){this.elem[axes]==0?prevElem.className=prevElem.className.replace(/\s*prevCurrent/g,""):prevElem.className.indexOf("prevCurrent")<0?prevElem.className+=" prevCurrent":"";}
if(nextElem){this.elem[axes]==maxTopScope-boxDcope?nextElem.className=nextElem.className.replace(/\s*nextCurrent/g,""):nextElem.className.indexOf("nextCurrent")<0?nextElem.className+=" nextCurrent":"";}};Scroll.prototype.stop=function(){this.isStop=1;clearTimeout(this.timer);};Scroll.prototype.start=function(){var that=this,time=this.o.rest||this.speed||1000;clearTimeout(this.timer);this.isStop=0;this.timer=setTimeout(function(){that.action()},time);};Scroll.prototype.prev=function(){var that=this;if(this.prevElement&&this.o.range&&this.isStop==0){this.prevElement.onclick=function(){if(that.isStop==1){return false};that.action(-1);}}};Scroll.prototype.next=function(){var that=this;if(this.nextElement&&this.o.range&&this.isStop==0){this.nextElement.onclick=function(){if(that.isStop==1){return false};that.action(1);}}};Scroll.prototype.g=function(elem){return typeof(elem)=="object"?elem:document.getElementById(elem)};Scroll.prototype.scrollAxes=function(){return this.o.move&&(this.o.move=="n"||this.o.move=="N"||this.o.move=="s"||this.o.move=="S")?"scrollTop":"scrollLeft";};Scroll.prototype.getStyle=function(elem,name){if(elem.style[name]!='')return elem.style[name];if(!!window.ActiveXObject)return elem.currentStyle[name];return document.defaultView.getComputedStyle(elem,"").getPropertyValue(name.replace(/([A-Z])/g,"-$1").toLowerCase());};Scroll.prototype.cpu=function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;};Scroll.prototype.slowdown=function(finish,_f){var count=0,elem=this.elem,plan=this.scrollAxes(),start=elem[plan],finish=finish%this.o.range==0?finish:finish%this.o.range+finish,space=finish-start,speed=this.speed,that=this,command;function place(){elem[plan]=that.cpu(count,start,space,speed);count++;if(count===speed){clearTimeout(command);count=0;elem[plan]=space+start;if(_f)_f();return false;}
command=setTimeout(place,15);}
place();};